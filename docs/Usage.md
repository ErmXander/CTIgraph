# Usage
The components of the project can be experimented with by using the script ```graph_generate.py```.  
The script allows to extract MulVAL inputs from the K8s infrastructure description and STIX Bundle, use the extracted inputs to generate an Attack Graph and use such graph to perform different operations:  
```bash
python graph_generate.py <k8s-infrastructure.json> <cti-report.json> <opts>
```
#### the avaiable options include:
- **-o, --output**: output directory (default is working directory).
- **--kb**: specify a different directory to use as Knowledge Base containing MITRE ATT&CK, D3FEND and DAO information (default is ```./kb/```).
- **-l, --location**: specify a pod to consider the attacker's initial location (by default the attack is located in internet).
- **-g, --graph**: extract MulVAL inputs and use them to generate an Attack Graph.
- **-u, --unpruned**: do not prune the graph generated by MulVAL.
- **-a, --all**: keep all output files generated by MulVAL.
- **-f, --flow**: convert the generated graph to an Attack Flow compliant JSON representation.
- **-m, --mermaid**: convert the generated graph to a Mermaid .mmd graph.
- **-d, --defend**: use the generated graph to suggest D3FEND countermeasures to apply to the infrastructure.