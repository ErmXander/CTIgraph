primitive(attackerLocated,1).
primitive(vulExists,3).
primitive(hasLibrary,3).
primitive(hasArtifact,2).
primitive(exposesService,4).
primitive(misconfiguration,2).
primitive(mounts,3).
primitive(dependsOn,2).
primitive(hasTrustLevel,2).
primitive(netRule,5).
primitive(techniqueArtifact,2).
primitive(techniqueExploits,2).
primitive(unachievable,1).
derived(hacl,4).
derived(vulExists,2).
derived(podArtifact,2).
derived(reachable,3).
derived(podTargetable,2).
derived(podExploitable,2).
derived(dos,1).
derived(codeExec,1).
derived(fileAccess,3).
derived(privilege,2).
derived(credentialAccess,1).
derived(remoteAccess,1).
derived(persistence,1).
derived(dataManipulation,1).
derived(t1_attack_step,1).
derived(t2_attack_step,1).
derived(t3_attack_step,1).
derived(t14_attack_step,1).
derived(t15_attack_step,1).
derived(t18_attack_step,1).
derived(t6_attack_step,1).
meta(attackGoal,1).
meta(advances,2).

attack(codeExec(p2)).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p2,art3),[hasArtifact(lib1,art3),hasLibrary(p2,lib1,lib1_ver2)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p2,art3),[hasArtifact(lib1,art3),hasLibrary(p2,lib1,lib1_ver2)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p2,art1),[hasArtifact(ps2,art1),exposesService(p2,ps2,tcp,8080)])).

possible_duplicate_trace_step(because(0,rule_desc('pod vulnerable',0.0),vulExists(p2,vul1),[hasLibrary(p2,lib1,lib1_ver2),vulExists(lib1,lib1_ver2,vul1)])).

possible_duplicate_trace_step(because(9,rule_desc('compatible art+vuln',0.0),podExploitable(p2,t1),[techniqueExploits(t1,vul1),vulExists(p2,vul1),techniqueArtifact(t1,art1),podArtifact(p2,art1)])).

possible_duplicate_trace_step(because(5,rule_desc('',0.0),hacl(internet,p2,_h7452,_h7453),[netRule(p2,internet,_h7452,_h7453,ingress)])).

possible_duplicate_trace_step(because(6,rule_desc('directly reachable',0.0),reachable(p2,_h7452,_h7453),[hacl(internet,p2,_h7452,_h7453),attackerLocated(internet)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p1,art3),[hasArtifact(lib1,art3),hasLibrary(p1,lib1,lib1_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p1,art3),[hasArtifact(lib1,art3),hasLibrary(p1,lib1,lib1_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p1,art4),[hasArtifact(lib2,art4),hasLibrary(p1,lib2,lib2_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p2,art3),[hasArtifact(lib1,art3),hasLibrary(p2,lib1,lib1_ver2)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p2,art3),[hasArtifact(lib1,art3),hasLibrary(p2,lib1,lib1_ver2)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p3,art6),[hasArtifact(lib3,art6),hasLibrary(p3,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p3,art6),[hasArtifact(lib3,art6),hasLibrary(p3,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p3,art6),[hasArtifact(lib3,art6),hasLibrary(p3,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p4,art6),[hasArtifact(lib3,art6),hasLibrary(p4,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p4,art6),[hasArtifact(lib3,art6),hasLibrary(p4,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p4,art6),[hasArtifact(lib3,art6),hasLibrary(p4,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p5,art9),[hasArtifact(lib4,art9),hasLibrary(p5,lib4,lib4_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p6,art10),[hasArtifact(lib5,art10),hasLibrary(p6,lib5,lib5_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p6,art10),[hasArtifact(lib5,art10),hasLibrary(p6,lib5,lib5_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p7,art10),[hasArtifact(lib5,art10),hasLibrary(p7,lib5,lib5_ver2)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p7,art10),[hasArtifact(lib5,art10),hasLibrary(p7,lib5,lib5_ver2)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p8,art13),[hasArtifact(lib6,art13),hasLibrary(p8,lib6,lib6_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p9,art6),[hasArtifact(lib3,art6),hasLibrary(p9,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p9,art6),[hasArtifact(lib3,art6),hasLibrary(p9,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p9,art6),[hasArtifact(lib3,art6),hasLibrary(p9,lib3,lib3_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p9,art10),[hasArtifact(lib7,art10),hasLibrary(p9,lib7,lib7_ver1)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p1,art1),[hasArtifact(ps1,art1),exposesService(p1,ps1,tcp,80)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p1,art2),[hasArtifact(ps1,art2),exposesService(p1,ps1,tcp,80)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p2,art1),[hasArtifact(ps2,art1),exposesService(p2,ps2,tcp,8080)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p3,art4),[hasArtifact(ps3,art4),exposesService(p3,ps3,tcp,3030)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p3,art5),[hasArtifact(ps3,art5),exposesService(p3,ps3,tcp,3030)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p4,art4),[hasArtifact(ps4,art4),exposesService(p4,ps4,tcp,4040)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p5,art7),[hasArtifact(ps5,art7),exposesService(p5,ps5,tcp,5050)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p5,art8),[hasArtifact(ps5,art8),exposesService(p5,ps5,tcp,5050)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p6,art5),[hasArtifact(ps6,art5),exposesService(p6,ps6,tcp,6060)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p7,art10),[hasArtifact(ps7,art10),exposesService(p7,ps7,tcp,7070)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p7,art11),[hasArtifact(ps7,art11),exposesService(p7,ps7,tcp,7070)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p8,art12),[hasArtifact(ps8,art12),exposesService(p8,ps8,tcp,8888)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p9,art4),[hasArtifact(ps9,art4),exposesService(p9,ps9,tcp,9090)])).

possible_duplicate_trace_step(because(0,rule_desc('pod vulnerable',0.0),vulExists(p1,vul1),[hasLibrary(p1,lib1,lib1_ver1),vulExists(lib1,lib1_ver1,vul1)])).

possible_duplicate_trace_step(because(0,rule_desc('pod vulnerable',0.0),vulExists(p1,vul2),[hasLibrary(p1,lib2,lib2_ver1),vulExists(lib2,lib2_ver1,vul2)])).

possible_duplicate_trace_step(because(9,rule_desc('compatible art+vuln',0.0),podExploitable(p1,t1),[techniqueExploits(t1,vul1),vulExists(p1,vul1),techniqueArtifact(t1,art1),podArtifact(p1,art1)])).

possible_duplicate_trace_step(because(9,rule_desc('compatible art+vuln',0.0),podExploitable(p2,t1),[techniqueExploits(t1,vul1),vulExists(p2,vul1),techniqueArtifact(t1,art1),podArtifact(p2,art1)])).

possible_duplicate_trace_step(because(19,rule_desc('TECHNIQUE t1',0.0),t1_attack_step(p2),[reachable(p2,_h7577,_h7578),podExploitable(p2,t1)])).

possible_duplicate_trace_step(because(5,rule_desc('',0.0),hacl(internet,p1,_h7577,_h7578),[netRule(p1,internet,_h7577,_h7578,ingress)])).

possible_duplicate_trace_step(because(6,rule_desc('directly reachable',0.0),reachable(p1,_h7577,_h7578),[hacl(internet,p1,_h7577,_h7578),attackerLocated(internet)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p1,t2),[techniqueArtifact(t2,art1),podArtifact(p1,art1)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p2,t2),[techniqueArtifact(t2,art1),podArtifact(p2,art1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p1,art3),[hasArtifact(lib1,art3),hasLibrary(p1,lib1,lib1_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p1,art3),[hasArtifact(lib1,art3),hasLibrary(p1,lib1,lib1_ver1)])).

possible_duplicate_trace_step(because(1,rule_desc('',0.0),podArtifact(p1,art4),[hasArtifact(lib2,art4),hasLibrary(p1,lib2,lib2_ver1)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p1,art1),[hasArtifact(ps1,art1),exposesService(p1,ps1,tcp,80)])).

possible_duplicate_trace_step(because(2,rule_desc('',0.0),podArtifact(p1,art2),[hasArtifact(ps1,art2),exposesService(p1,ps1,tcp,80)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p1,t6),[techniqueArtifact(t6,art2),podArtifact(p1,art2)])).

possible_duplicate_trace_step(because(9,rule_desc('compatible art+vuln',0.0),podExploitable(p1,t1),[techniqueExploits(t1,vul1),vulExists(p1,vul1),techniqueArtifact(t1,art1),podArtifact(p1,art1)])).

possible_duplicate_trace_step(because(19,rule_desc('TECHNIQUE t1',0.0),t1_attack_step(p1),[reachable(p1,_h8124,_h8125),podExploitable(p1,t1)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p1,t2),[techniqueArtifact(t2,art1),podArtifact(p1,art1)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p1,t3),[techniqueArtifact(t3,art1),podArtifact(p1,art1)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p1,t3),[techniqueArtifact(t3,art1),podArtifact(p1,art1)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p2,t3),[techniqueArtifact(t3,art1),podArtifact(p2,art1)])).

possible_duplicate_trace_step(because(20,rule_desc('COMPROMISED - Code Execution',0.0),codeExec(p1),[t1_attack_step(p1)])).

possible_duplicate_trace_step(because(19,rule_desc('TECHNIQUE t1',0.0),t1_attack_step(p1),[reachable(p1,_h7577,_h7578),podExploitable(p1,t1)])).

possible_duplicate_trace_step(because(20,rule_desc('COMPROMISED - Code Execution',0.0),codeExec(p2),[t1_attack_step(p2)])).

possible_duplicate_trace_step(because(20,rule_desc('COMPROMISED - Code Execution',0.0),codeExec(p1),[t1_attack_step(p1)])).

possible_duplicate_trace_step(because(30,rule_desc('TECHNIQUE t6',0.0),t6_attack_step(p1),[codeExec(p1),podTargetable(p1,t6)])).

possible_duplicate_trace_step(because(31,rule_desc('COMPROMISED - Privilege Esclation',0.0),privilege(p1,root),[t6_attack_step(p1)])).

possible_duplicate_trace_step(because(21,rule_desc('TECHNIQUE t2',0.0),t2_attack_step(p1),[privilege(p1,root),reachable(p1,_h7823,_h7824),podTargetable(p1,t2)])).

possible_duplicate_trace_step(because(21,rule_desc('TECHNIQUE t2',0.0),t2_attack_step(p1),[privilege(p1,root),reachable(p1,_h8200,_h8201),podTargetable(p1,t2)])).

possible_duplicate_trace_step(because(22,rule_desc('COMPROMISED - Code Execution',0.0),codeExec(p1),[t2_attack_step(p1)])).

possible_duplicate_trace_step(because(22,rule_desc('COMPROMISED - Code Execution',0.0),codeExec(p1),[t2_attack_step(p1)])).

possible_duplicate_trace_step(because(30,rule_desc('TECHNIQUE t6',0.0),t6_attack_step(p1),[codeExec(p1),podTargetable(p1,t6)])).

possible_duplicate_trace_step(because(19,rule_desc('TECHNIQUE t1',0.0),t1_attack_step(p2),[reachable(p2,_h7452,_h7453),podExploitable(p2,t1)])).

possible_duplicate_trace_step(because(20,rule_desc('COMPROMISED - Code Execution',0.0),codeExec(p2),[t1_attack_step(p2)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p2,t2),[techniqueArtifact(t2,art1),podArtifact(p2,art1)])).

possible_duplicate_trace_step(because(10,rule_desc('compatible artifact',0.0),podTargetable(p2,t3),[techniqueArtifact(t3,art1),podArtifact(p2,art1)])).

attack(codeExec(p1)).

attack(privilege(p1,root)).

